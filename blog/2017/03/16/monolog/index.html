<!DOCTYPE html><html lang="en"><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Monolog</title><meta name="author" content="Jamie Brandon" /><link rel="alternate" type="application/rss+xml" title="Scattered Thoughts - " href="/feed.xml" /><style> @import url("https://fonts.googleapis.com/css?family=Fira+Code:400,700|Fira+Sans:400,400i,700,700i&display=swap");progress,sub,sup{vertical-align:baseline}button,hr,input{overflow:visible}html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}figcaption,menu,article,aside,details,figure,footer,header,main,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,select{text-transform:none}[type=submit],[type=reset],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:ButtonText dotted 1px}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}code{background:#ffffff}.highlight{background:#ffffff}.highlight pre{background-color:#fff;font-size:16px}.highlight .c{color:#999988;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#999988;font-style:italic}.highlight .cp{color:#999999;font-weight:bold}.highlight .c1{color:#999988;font-style:italic}.highlight .cs{color:#999999;font-weight:bold;font-style:italic}.highlight .gd{color:#000000;background-color:#fdd}.highlight .gd .x{color:#000000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000000;background-color:#dfd}.highlight .gi .x{color:#000000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#445588;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:teal}.highlight .nb{color:#0086B3}.highlight .nc{color:#445588;font-weight:bold}.highlight .no{color:teal}.highlight .ni{color:purple}.highlight .ne{color:#990000;font-weight:bold}.highlight .nf{color:#990000;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:navy}.highlight .nv{color:teal}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:teal}.highlight .vg{color:teal}.highlight .vi{color:teal}.highlight .il{color:#099}.highlight .lineno{color:rgba(0,0,0,0.3);padding:0 10px;-webkit-user-select:none;-moz-user-select:none;-o-user-select:none}.lineno::-moz-selection{background-color:transparent}.lineno::selection{background-color:transparent}body{padding:32px;color:#333333;background-color:#ffffff;font-family:Fira Sans, serif}.container{max-width:45em;margin:0 auto;font-size:20px}body blockquote{border-left:2px solid #333333 !important}article{font-size:1em}h1,h2,h3{font-weight:800;font-family:Fira Sans, sans-serif}h1{text-align:center;font-size:2.0em}h2{text-align:center;font-size:1.2em;margin-top:4em}h3{text-align:center;font-size:1em}h4{text-align:center}a{text-decoration:underline;font-weight:normal}a,a:visited,a:hover,a:active{color:#0085a1}*{max-width:100%}pre,figure,.wp-caption{margin:0px -10px 20px -10px;padding:0px 10px 0px 10px}blockquote{margin:0;padding:0px 10px 0px 10px;border-radius:5px}p>img:only-child,p>a:only-child>img:only-child,.wp-caption img,figure img{display:block}img{margin-left:auto;margin-right:auto}.caption,.wp-caption-text,figcaption{font-size:0.9em;line-height:1.48em;font-style:italic}code,pre{white-space:pre;overflow:visible;font-family:Fira Code, monospace}ul,ol{padding:0}ul{padding-left:30px;list-style:disc}ol{padding-left:30px;list-style:decimal}.post-link{padding-bottom:10px;text-align:center}.post-link a{text-decoration:none;color:#333333}.post-link a:focus,.post-link a:hover{color:#0085a1}.post-link .post-title{margin:0;font-size:18px}nav{text-align:center}nav a{font-size:1.4em}nav a,nav a:visited{text-decoration:none;color:#333333}nav a:focus,nav a:hover{color:#0085a1}.menu ul{list-style:none;padding:0;margin:0}header{margin:2em 0 2em 0;text-align:center}header h1{margin:0}footer{margin-top:4em;text-align:center;font-style:italic}iframe{width:560px;height:315px;display:block;margin:0 auto;padding-top:1em}table{margin-left:auto;margin-right:auto;border-collapse:collapse}table,th,td{padding:0.5em;border:0.5px solid #333333}hr{width:7em;margin-top:3em;margin-bottom:3em;border:0;height:1px;background-image:linear-gradient(to right, transparent, rgba(0,0,0,0.75), transparent)}</style><nav> <a href="/"> JAMIE BRANDON </a></nav><div class="container"><header><h1>Monolog</h1></header><article role="main"><p>Suppose I want to track how I spend my day. There are plenty of existing time-tracking apps, but none of them were invented here.<p>I could build an app from scratch. I would just need to write code for displaying entries, adding new entries, editing old entries, summarizing data, storing data, tracking changes…<p>Or I could just dump it in a spreadsheet, add a few formulas and call it a day.<p>This is the real magic of spreadsheets - there is a large class of problems where just pasting the data into an editable grid provides 90% of the necessary interactions, and adding a few formulae and charts handles the remaining 10%.<p>And having noticed that, you have to also wonder if there are other classes of problems where a similar 90%-done UI paradigm might exist.<p>As it turns out, putting my time-tracker in a spreadsheet doesn’t quite solve the problem, because the biggest problem I have with time-trackers is that I forget to use them. I want a time-tracker that can pop up a notification to ask me if I’ve really been writing a blog post for 27 hours or if I just forgot to check out.<p>The same goes for todo lists, <a href="https://en.wikipedia.org/wiki/Experience_sampling_method">experience samplers</a>, lab journals, quantified-self shenanigans etc. They all need to record when things happen and prompt actions from the user at specific times.<p>So I made <a href="https://github.com/jamii/monolog">monolog</a>: a semi-successful experiment in making a 90%-done UI for journal-like problems.<p>The core data model is a log of timestamped plain-text entries.<p><img src="/img/monolog1.png" alt="" /><p>The entries and the timestamp are both editable.<p><img src="/img/monolog2.png" alt="" /><p>Snippets of code can annotate entries with arbitrary html.<div class="language-cljs highlighter-rouge"><pre class="highlight"><code><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="no">:todo</span><span class="w"> </span><span class="p">(</span><span class="err">@</span><span class="n">todos</span><span class="w"> </span><span class="p">(</span><span class="no">:ix</span><span class="w"> </span><span class="n">message</span><span class="p">)))</span><span class="w">
  </span><span class="p">[</span><span class="no">:button</span><span class="w"> </span><span class="p">{</span><span class="no">:style</span><span class="w"> </span><span class="p">{</span><span class="no">:margin</span><span class="w"> </span><span class="s">"0px 5px 0px 5px"</span><span class="w">
                    </span><span class="no">:padding</span><span class="w"> </span><span class="s">"0px 10px 0px 10px"</span><span class="p">}</span><span class="w">
            </span><span class="no">:on-click</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nf">log!</span><span class="w"> </span><span class="p">{</span><span class="no">:contents</span><span class="w"> </span><span class="p">(</span><span class="nf">.replace</span><span class="w"> </span><span class="p">(</span><span class="no">:contents</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="s">"#todo"</span><span class="w"> </span><span class="s">"#task"</span><span class="p">)})}</span><span class="w">
   </span><span class="s">"↻"</span><span class="p">])</span><span class="w">
</span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="no">:todo</span><span class="w"> </span><span class="p">(</span><span class="err">@</span><span class="n">todos</span><span class="w"> </span><span class="p">(</span><span class="no">:ix</span><span class="w"> </span><span class="n">message</span><span class="p">)))</span><span class="w">
  </span><span class="p">[</span><span class="no">:button</span><span class="w"> </span><span class="p">{</span><span class="no">:style</span><span class="w"> </span><span class="p">{</span><span class="no">:margin</span><span class="w"> </span><span class="s">"0px 5px 0px 5px"</span><span class="w">
                    </span><span class="no">:padding</span><span class="w"> </span><span class="s">"0px 10px 0px 10px"</span><span class="p">}</span><span class="w">
          </span><span class="no">:on-click</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nf">log!</span><span class="w"> </span><span class="p">{</span><span class="no">:contents</span><span class="w"> </span><span class="p">(</span><span class="nb">str</span><span class="w"> </span><span class="s">"#done #"</span><span class="w"> </span><span class="p">(</span><span class="no">:ix</span><span class="w"> </span><span class="n">message</span><span class="p">))})}</span><span class="w">
   </span><span class="s">"✓"</span><span class="p">])</span><span class="w">
</span></code></pre></div><p><img src="/img/monolog3.png" alt="" /><p>Clicking on the tick button marks the todo as done.<p><img src="/img/monolog4.png" alt="" /><p>Clicking on the refresh button turns the todo into a current task.<p><img src="/img/monolog5.png" alt="" /><p>Other code snippets can annotate the entries with interpretations of their contents, such as parsing durations and times.<div class="language-cljs highlighter-rouge"><pre class="highlight"><code><span class="p">(</span><span class="nb">doseq</span><span class="w"> </span><span class="p">[</span><span class="n">message</span><span class="w"> </span><span class="n">messages</span><span class="w">
        </span><span class="no">:when</span><span class="w"> </span><span class="p">(</span><span class="nb">nil?</span><span class="w"> </span><span class="p">(</span><span class="err">@</span><span class="n">natty</span><span class="w"> </span><span class="n">message</span><span class="p">))]</span><span class="w">
  </span><span class="p">(</span><span class="nf">xhrio/send</span><span class="w"> </span><span class="s">"/natty"</span><span class="w">
              </span><span class="o">#</span><span class="p">(</span><span class="nf">swap!</span><span class="w"> </span><span class="n">natty</span><span class="w"> </span><span class="nb">assoc</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="p">(</span><span class="nf">read-string</span><span class="w"> </span><span class="p">(</span><span class="nb">-&gt;</span><span class="w"> </span><span class="n">%</span><span class="w"> </span><span class="n">.-target</span><span class="w"> </span><span class="n">.getResponseText</span><span class="p">)))</span><span class="w">
              </span><span class="s">"POST"</span><span class="w">
              </span><span class="p">(</span><span class="nb">pr-str</span><span class="w"> </span><span class="p">{</span><span class="no">:message</span><span class="w"> </span><span class="n">message</span><span class="p">})</span><span class="w">
              </span><span class="p">(</span><span class="nf">structs/Map.</span><span class="w"> </span><span class="o">#</span><span class="n">js</span><span class="w"> </span><span class="p">{</span><span class="no">:Content-Type</span><span class="w"> </span><span class="s">"application/edn"</span><span class="p">})))</span><span class="w">
</span></code></pre></div><p><img src="/img/monolog6.png" alt="" /><p>And another snippet uses the estimated durations of tasks to decide when to nudge the user about overrunning.<div class="language-cljs highlighter-rouge"><pre class="highlight"><code><span class="p">(</span><span class="nb">when-let</span><span class="w"> </span><span class="p">[</span><span class="n">last-task</span><span class="w"> </span><span class="p">(</span><span class="nb">first</span><span class="w"> </span><span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">[</span><span class="n">task</span><span class="w"> </span><span class="p">(</span><span class="nb">reverse</span><span class="w"> </span><span class="err">@</span><span class="n">tasks</span><span class="p">)</span><span class="w">
                                  </span><span class="no">:when</span><span class="w"> </span><span class="n">task</span><span class="p">]</span><span class="w">
                              </span><span class="n">task</span><span class="p">))]</span><span class="w">
  </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="no">:duration</span><span class="w"> </span><span class="n">last-task</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">:estimate</span><span class="w"> </span><span class="n">last-task</span><span class="p">))</span><span class="w">
    </span><span class="p">[</span><span class="n">nudge-ui</span><span class="w"> </span><span class="p">(</span><span class="nb">str</span><span class="w"> </span><span class="s">"Your last "</span><span class="w"> </span><span class="p">(</span><span class="nb">-&gt;</span><span class="w"> </span><span class="n">last-task</span><span class="w"> </span><span class="no">:kind</span><span class="w"> </span><span class="nb">name</span><span class="p">)</span><span class="w"> </span><span class="s">" is at "</span><span class="w"> </span><span class="p">(</span><span class="no">:duration</span><span class="w"> </span><span class="n">last-task</span><span class="p">)</span><span class="w"> </span><span class="s">" / "</span><span class="w"> </span><span class="p">(</span><span class="no">:estimate</span><span class="w"> </span><span class="n">last-task</span><span class="p">)</span><span class="w"> </span><span class="s">" mins! What are you up to?"</span><span class="p">)</span><span class="w"> </span><span class="s">"#task "</span><span class="p">]))</span><span class="w">
</span></code></pre></div><p><img src="/img/monolog7.png" alt="" /><p>The nudge can be cleared by adding a new task or break.<p><img src="/img/monolog8.png" alt="" /><p>Nudges also work for experience sampling. Clicking on this experience sampling nudge partially fills out a new log entry.<div class="language-cljs highlighter-rouge"><pre class="highlight"><code><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">last-sample</span><span class="w"> </span><span class="p">(</span><span class="nb">first</span><span class="w"> </span><span class="p">(</span><span class="k">for</span><span class="w"> </span><span class="p">[</span><span class="n">sample</span><span class="w"> </span><span class="p">(</span><span class="nb">reverse</span><span class="w"> </span><span class="err">@</span><span class="n">samples</span><span class="p">)</span><span class="w">
                               </span><span class="no">:when</span><span class="w"> </span><span class="n">sample</span><span class="p">]</span><span class="w">
                           </span><span class="n">sample</span><span class="p">))]</span><span class="w">
  </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nb">or</span><span class="w"> </span><span class="p">(</span><span class="nb">nil?</span><span class="w"> </span><span class="n">last-sample</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="err">@</span><span class="n">now</span><span class="w"> </span><span class="p">(</span><span class="no">:next-sample</span><span class="w"> </span><span class="n">last-sample</span><span class="p">)))</span><span class="w">
    </span><span class="p">[</span><span class="n">nudge-ui</span><span class="w"> </span><span class="p">(</span><span class="nb">str</span><span class="w"> </span><span class="s">"It's sampling time!"</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">str</span><span class="w"> </span><span class="s">"#sample  (next sample "</span><span class="w"> </span><span class="p">(</span><span class="nf">time-&gt;string</span><span class="w"> </span><span class="p">(</span><span class="nf">js/Date.</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nf">.getTime</span><span class="w"> </span><span class="err">@</span><span class="n">now</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="p">(</span><span class="nf">js/Math.random</span><span class="p">)</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">8</span><span class="p">))))</span><span class="w"> </span><span class="s">")"</span><span class="p">)</span><span class="w">
</span></code></pre></div><p><img src="/img/monolog9.png" alt="" /><p>Finally, filters can produce task-specific views of the log, like uncompleted todos or chargeable hours.<div class="language-cljs highlighter-rouge"><pre class="highlight"><code><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">filters</span><span class="w">
  </span><span class="p">{</span><span class="no">:all</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nf">do</span><span class="w"> </span><span class="n">true</span><span class="p">)</span><span class="w">
   </span><span class="no">:todo</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="no">:todo</span><span class="w"> </span><span class="p">(</span><span class="err">@</span><span class="n">todos</span><span class="w"> </span><span class="p">(</span><span class="no">:ix</span><span class="w"> </span><span class="n">%</span><span class="p">)))</span><span class="w">
   </span><span class="no">:projectx</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nf">contains</span><span class="w"> </span><span class="p">(</span><span class="no">:contents</span><span class="w"> </span><span class="n">%</span><span class="p">)</span><span class="w"> </span><span class="s">"#projectx"</span><span class="p">)})</span><span class="w">
</span></code></pre></div><div class="language-cljs highlighter-rouge"><pre class="highlight"><code><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="no">:projectx</span><span class="w"> </span><span class="err">@</span><span class="n">current-filter</span><span class="p">)</span><span class="w">
  </span><span class="p">[</span><span class="no">:div</span><span class="w"> </span><span class="p">{</span><span class="no">:style</span><span class="w"> </span><span class="p">{</span><span class="no">:font-weight</span><span class="w"> </span><span class="s">"bold"</span><span class="w">
                  </span><span class="no">:text-align</span><span class="w"> </span><span class="s">"center"</span><span class="w">
                  </span><span class="no">:flex</span><span class="w"> </span><span class="mi">1</span><span class="p">}}</span><span class="w">
   </span><span class="p">(</span><span class="nf">format</span><span class="w"> </span><span class="s">"%.0f hours - £%.2f"</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="err">@</span><span class="n">projectx-minutes</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="err">@</span><span class="n">projectx-minutes</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="mi">400</span><span class="p">))])</span><span class="w">
</span></code></pre></div><p><img src="/img/monolog10.png" alt="" /><p><img src="/img/monolog12.png" alt="" /><p>That’s ~200 loc for the base functionality plus ~200 loc for a time tracker, todo list, experience sampler and even a little repl. Since the only mutable state is the log and it’s only mutated by direct user actions, I can safely use <a href="https://github.com/bhauman/lein-figwheel">figwheel</a> to live-update the app whenever I hit save in the code. Adding new apps usually only takes a couple of minutes from idea to live implementation.<p>To be really useful though it needs to be a mobile app, and I never got around to figuring out to get the same live-coding experience that I get as a locally-served figwheel app. If I have to plug my phone in and run some build and deploy step it defeats a lot of the quick-and-hacky magic that I was aiming for. I’m sure it’s doable though - maybe someone can suggest a nice approach?<p>Anyway, I posted this mainly to illustrate this idea of a 90%-done UI and hopefully to prompt people to look at other classes of problems that might have good solutions. <a href="http://people.csail.mit.edu/ebakke/sieuferd/index.html">SIEUFERD</a> is trying to do this for CRUD apps. <a href="https://camlistore.org/">Camlistore</a> and co seem to want to do the same for unstructured data, but they don’t provide much in the way of interaction. What else is out there?</article><footer><div>Questions? Comments? Just want to chat?</div><div><a href="mailto:jamie@scattered-thoughts.net>jamie@scattered-thoughts.net">jamie@scattered-thoughts.net</a></div><br><p><a href="/feed.xml"><img src="/img/rss.png"></img></a></footer></div>
